// This is your Prisma schema file
// Migrated from Drizzle ORM to Prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

// Auth tables for better-auth
model User {
  id            String         @id
  name          String
  email         String         @unique
  emailVerified Boolean        @default(false) @map("email_verified")
  image         String?
  role          String         @default("user")
  phone         String?
  createdAt     DateTime       @default(now()) @map("created_at")
  updatedAt     DateTime       @updatedAt @map("updated_at")
  sessions      Session[]
  accounts      Account[]
  reviews       Review[]
  hosts         Host[]

  @@map("user")
}

model Session {
  id        String   @id
  expiresAt DateTime @map("expires_at")
  token     String   @unique
  createdAt DateTime @map("created_at")
  updatedAt DateTime @map("updated_at")
  ipAddress String?  @map("ip_address")
  userAgent String?  @map("user_agent")
  userId    String   @map("user_id")
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("session")
}

model Account {
  id                      String    @id
  accountId               String    @map("account_id")
  providerId              String    @map("provider_id")
  userId                  String    @map("user_id")
  accessToken             String?   @map("access_token")
  refreshToken            String?   @map("refresh_token")
  idToken                 String?   @map("id_token")
  accessTokenExpiresAt    DateTime? @map("access_token_expires_at")
  refreshTokenExpiresAt   DateTime? @map("refresh_token_expires_at")
  scope                   String?
  password                String?
  createdAt               DateTime  @map("created_at")
  updatedAt               DateTime  @map("updated_at")
  user                    User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("account")
}

model Verification {
  id         String   @id
  identifier String
  value      String
  expiresAt  DateTime @map("expires_at")
  createdAt  DateTime @default(now()) @map("created_at")
  updatedAt  DateTime @default(now()) @map("updated_at")

  @@map("verification")
}

model Host {
  id             Int        @id @default(autoincrement())
  userId         String?    @map("user_id")
  fullName       String     @map("full_name")
  profilePicture String?    @map("profile_picture")
  contactNumber  String?    @map("contact_number")
  bio            String?
  createdAt      String     @map("created_at")
  updatedAt      String     @map("updated_at")
  user           User?      @relation(fields: [userId], references: [id])
  properties     Property[]

  @@map("hosts")
}

model Property {
  id                  Int               @id @default(autoincrement())
  name                String
  city                String
  area                String
  type                String
  price               Int
  bestDealPrice       Int?              @map("best_deal_price")
  peakSeasonPrice     Int?              @map("peak_season_price")
  nights              Int               @default(2)
  rating              Float
  imageUrl            String            @map("image_url")
  isGuestFavorite     Boolean           @default(false) @map("is_guest_favorite")
  description         String?
  address             String?
  country             String?
  latitude            Float?
  longitude           Float?
  bedrooms            Int?
  bathrooms           Int?
  maxGuests           Int?              @map("max_guests")
  petsAllowed         Boolean?          @default(false) @map("pets_allowed")
  checkInTime         String?           @map("check_in_time")
  checkOutTime        String?           @map("check_out_time")
  images              Json?
  amenities           Json?
  hostId              Int?              @map("host_id")
  isPublished         Boolean?          @default(false) @map("is_published")
  propertyCategory    String?           @map("property_category")
  placeType           String?           @map("place_type")
  buildingName        String?           @map("building_name")
  unitFloor           String?           @map("unit_floor")
  district            String?
  postalCode          String?           @map("postal_code")
  beds                Int?
  bedroomLocks        Boolean?          @map("bedroom_locks")
  whoElse             Json?             @map("who_else")
  parkingType         String?           @map("parking_type")
  propertyRules       Json?             @map("property_rules")
  safetyItems         Json?             @map("safety_items")
  bio                 String?
  phoneNumber         String?           @map("phone_number")
  specialDescription  String?           @map("special_description")
  languageCode        String?           @map("language_code")
  currencyCode        String?           @map("currency_code")
  createdAt           String            @map("created_at")
  updatedAt           String            @map("updated_at")
  host                Host?             @relation(fields: [hostId], references: [id])
  rooms               Room[]
  reviews             Review[]
  propertyPricing     PropertyPricing[]
  propertyImages      PropertyImage[]
  propertyAmenities   PropertyAmenity[]
  peakSeasonRates     PeakSeasonRate[]

  @@map("properties")
}

model Room {
  id                  Int                @id @default(autoincrement())
  propertyId          Int                @map("property_id")
  name                String
  type                String
  pricePerNight       Int                @map("price_per_night")
  maxGuests           Int                @map("max_guests")
  beds                Json?
  size                Int?
  amenities           Json?
  available           Boolean?           @default(true)
  roomNumber          Int?               @map("room_number")
  inRoomAmenities     Json?              @map("in_room_amenities")
  bathroomFacilities  Json?              @map("bathroom_facilities")
  additionalFeatures  Json?              @map("additional_features")
  technologyComfort   Json?              @map("technology_comfort")
  extraServices       Json?              @map("extra_services")
  hasLock             Boolean?           @map("has_lock")
  createdAt           String             @map("created_at")
  updatedAt           String             @map("updated_at")
  property            Property           @relation(fields: [propertyId], references: [id])
  propertyPricing     PropertyPricing[]
  roomAvailability    RoomAvailability[]
  peakSeasonRates     PeakSeasonRate[]

  @@map("rooms")
}

model Review {
  id            Int      @id @default(autoincrement())
  propertyId    Int?     @map("property_id")
  userId        String?  @map("user_id")
  userName      String   @map("user_name")
  userAvatar    String?  @map("user_avatar")
  rating        Float
  comment       String
  cleanliness   Float?
  accuracy      Float?
  communication Float?
  location      Float?
  value         Float?
  createdAt     String   @map("created_at")
  updatedAt     String   @map("updated_at")
  property      Property? @relation(fields: [propertyId], references: [id])
  user          User?    @relation(fields: [userId], references: [id])

  @@map("reviews")
}

model PropertyPricing {
  id         Int      @id @default(autoincrement())
  propertyId Int      @map("property_id")
  roomId     Int?     @map("room_id")
  date       String
  price      Int
  priceType  String   @map("price_type")
  createdAt  String   @map("created_at")
  updatedAt  String   @map("updated_at")
  property   Property @relation(fields: [propertyId], references: [id])
  room       Room?    @relation(fields: [roomId], references: [id])

  @@map("property_pricing")
}

model PropertyImage {
  id           Int      @id @default(autoincrement())
  propertyId   Int      @map("property_id")
  imageUrl     String   @map("image_url")
  displayOrder Int      @map("display_order")
  isCover      Boolean? @default(false) @map("is_cover")
  createdAt    String   @map("created_at")
  updatedAt    String   @map("updated_at")
  property     Property @relation(fields: [propertyId], references: [id])

  @@map("property_images")
}

model PropertyAmenity {
  id          Int      @id @default(autoincrement())
  propertyId  Int      @map("property_id")
  amenityName String   @map("amenity_name")
  amenityType String   @map("amenity_type")
  createdAt   String   @map("created_at")
  updatedAt   String   @map("updated_at")
  property    Property @relation(fields: [propertyId], references: [id])

  @@map("property_amenities")
}

model RoomAvailability {
  id          Int     @id @default(autoincrement())
  roomId      Int     @map("room_id")
  date        String
  isAvailable Boolean @default(true) @map("is_available")
  createdAt   String  @map("created_at")
  updatedAt   String  @map("updated_at")
  room        Room    @relation(fields: [roomId], references: [id], onDelete: Cascade)

  @@map("room_availability")
}

model PeakSeasonRate {
  id                 Int       @id @default(autoincrement())
  roomId             Int?      @map("room_id")
  propertyId         Int?      @map("property_id")
  startDate          String    @map("start_date")
  endDate            String    @map("end_date")
  priceIncrease      Int       @map("price_increase")
  percentageIncrease Float?    @map("percentage_increase")
  isActive           Boolean   @default(true) @map("is_active")
  createdAt          String    @map("created_at")
  updatedAt          String    @map("updated_at")
  room               Room?     @relation(fields: [roomId], references: [id], onDelete: Cascade)
  property           Property? @relation(fields: [propertyId], references: [id], onDelete: Cascade)

  @@map("peak_season_rates")
}

model Language {
  id        Int     @id @default(autoincrement())
  code      String  @unique
  name      String
  region    String
  isActive  Boolean @default(true) @map("is_active")
  createdAt String  @map("created_at")
  updatedAt String  @map("updated_at")

  @@map("languages")
}

model Currency {
  id        Int     @id @default(autoincrement())
  code      String  @unique
  name      String
  symbol    String
  rate      Float
  isActive  Boolean @default(true) @map("is_active")
  createdAt String  @map("created_at")
  updatedAt String  @map("updated_at")

  @@map("currencies")
}